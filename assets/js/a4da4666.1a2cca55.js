"use strict";(self.webpackChunkiota_wiki=self.webpackChunkiota_wiki||[]).push([[29715],{40446:function(e,t,a){a.r(t),a.d(t,{assets:function(){return d},contentTitle:function(){return s},default:function(){return p},frontMatter:function(){return c},metadata:function(){return l},toc:function(){return h}});var n=a(87462),i=a(63366),o=(a(67294),a(3905)),r=["components"],c={description:"Create, fund and, deploy a new EVM Chain using IOTA Smart Contracts.",image:"/img/logo/WASP_logo_dark.png",keywords:["create","chain","EVM","Solidity","deploy","hardhat","metamask","JSON","RPC","how to"]},s="Creating an EVM Chain",l={unversionedId:"guide/evm/create-chain",id:"guide/evm/create-chain",title:"Creating an EVM Chain",description:"Create, fund and, deploy a new EVM Chain using IOTA Smart Contracts.",source:"@site/content/build/wasp/develop/documentation/docs/guide/evm/create-chain.md",sourceDirName:"guide/evm",slug:"/guide/evm/create-chain",permalink:"/smart-contracts/guide/evm/create-chain",draft:!1,editUrl:"https://github.com/iotaledger/wasp/edit/develop/documentation/content/build/wasp/develop/documentation/docs/guide/evm/create-chain.md",tags:[],version:"current",frontMatter:{description:"Create, fund and, deploy a new EVM Chain using IOTA Smart Contracts.",image:"/img/logo/WASP_logo_dark.png",keywords:["create","chain","EVM","Solidity","deploy","hardhat","metamask","JSON","RPC","how to"]},sidebar:"tutorialSidebar",previous:{title:"EVM Limitations within IOTA Smart Contracts",permalink:"/smart-contracts/guide/evm/limitations"},next:{title:"EVM Tooling",permalink:"/smart-contracts/guide/evm/tooling"}},d={},h=[{value:"1. Create the IOTA Smart Contracts Chain",id:"1-create-the-iota-smart-contracts-chain",level:2},{value:"2. Fund Your Account on Your IOTA Smart Contracts Chain",id:"2-fund-your-account-on-your-iota-smart-contracts-chain",level:2},{value:"3. Deploy the EVM Chain Contract",id:"3-deploy-the-evm-chain-contract",level:2},{value:"Running the JSON-RPC Interface",id:"running-the-json-rpc-interface",level:2},{value:"Video Tutorial",id:"video-tutorial",level:2}],u={toc:h};function p(e){var t=e.components,c=(0,i.Z)(e,r);return(0,o.kt)("wrapper",(0,n.Z)({},u,c,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"creating-an-evm-chain"},"Creating an EVM Chain"),(0,o.kt)("p",null,"EVM chains run inside IOTA Smart Contracts chains. So in order to start an EVM chain, you will first need to follow the steps to ",(0,o.kt)("a",{parentName:"p",href:"/smart-contracts/guide/chains_and_nodes/setting-up-a-chain"},"start an IOTA Smart Contracts chain"),", or use an existing IOTA Smart Contracts chain to start the EVM chain on."),(0,o.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("strong",{parentName:"p"},"An IOTA Smart Contracts chain can only contain 1 EVM chain contract"),". If your IOTA Smart Contracts chain already has an EVM chain contract, you should use that chain contract instead of creating a new one."))),(0,o.kt)("h2",{id:"1-create-the-iota-smart-contracts-chain"},"1. Create the IOTA Smart Contracts Chain"),(0,o.kt)("p",null,"If you don't have an IOTA Smart Contracts chain, you should create one. To do so, follow the instructions ",(0,o.kt)("a",{parentName:"p",href:"/smart-contracts/guide/chains_and_nodes/setting-up-a-chain"},"on setting up a chain"),"."),(0,o.kt)("h2",{id:"2-fund-your-account-on-your-iota-smart-contracts-chain"},"2. Fund Your Account on Your IOTA Smart Contracts Chain"),(0,o.kt)("p",null,"In order to deploy the EVM chain contract, you need to have some IOTA locked on your newly created chain to fund that action. To do this, run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"wasp-cli chain deposit IOTA:10000\n")),(0,o.kt)("p",null,"This locks 10000 IOTA into your name on your chain, which can be used on to pay for the creation of the EVM Chain contract."),(0,o.kt)("h2",{id:"3-deploy-the-evm-chain-contract"},"3. Deploy the EVM Chain Contract"),(0,o.kt)("p",null,"In order to deploy the EVM Chain contract, you need to make sure that the token that will be used on that chain is supplied right at its inception to a given address. You will have to generate a compatible address with a private key file. "),(0,o.kt)("p",null,"The most intuitive way to do this is by using ",(0,o.kt)("a",{parentName:"p",href:"https://metamask.io"},"Metamask"),". In MetaMask,  you can create a wallet (it does not matter what chain it is connected to). Once a wallet is generated, you will see a wallet address under its name. You can copy this to your clipboard. This is the address that will receive the full supply of tokens on that chain."),(0,o.kt)("p",null,(0,o.kt)("a",{target:"_blank",href:a(22910).Z},(0,o.kt)("img",{alt:"MetaMask",src:a(15115).Z,width:"375",height:"284"}))),(0,o.kt)("p",null,"Once you have this, you are ready to deploy the EVM chain with the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"wasp-cli chain evm deploy -a mychain --alloc 0x63c00c65BE86463491167eE26958a5A599BEbD2c:1000000000000000000000000\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"-a")," parameter indicates the name of the chain that you want to deploy your EVM chain on top of. ",(0,o.kt)("inlineCode",{parentName:"li"},"mychain")," in this case."),(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"--alloc")," parameter is the address that you copied from metamask(",(0,o.kt)("inlineCode",{parentName:"li"},"0x63c00c65BE86463491167eE26958a5A599BEbD2c")," in this case), followed by a ",(0,o.kt)("inlineCode",{parentName:"li"},":"),", and the value of Smart Contract Tokens that you want to be available to for use on EVM(",(0,o.kt)("inlineCode",{parentName:"li"},"1000000")," tokens in this case, followed by 18 decimal zeroes).")),(0,o.kt)("p",null,"Once this command has been executed successfully your EVM chain is up and running, and ready to be used."),(0,o.kt)("p",null,"You can verify the chain has been deployed by visiting the wasp dashboard and checking the smart contracts deployed on the chain. You should be able to see an evm contract over there."),(0,o.kt)("h2",{id:"running-the-json-rpc-interface"},"Running the JSON-RPC Interface"),(0,o.kt)("p",null,"In order to communicate with the EVM contract, you will need to run an additional server application that is compatible with how interactions usually takes place on other networks. This allows you to use other tools from those ecosystems like ",(0,o.kt)("a",{parentName:"p",href:"https://metamask.io"},"MetaMask")," and ",(0,o.kt)("a",{parentName:"p",href:"https://hardhat.org/"},"Hardhat")," to connect to our EVM chain. "),(0,o.kt)("p",null,"To run this server, run the following command: "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"wasp-cli chain evm jsonrpc --chainid 1074\n")),(0,o.kt)("p",null,"This will start the ",(0,o.kt)("a",{parentName:"p",href:"https://www.jsonrpc.org/"},"JSON-RPC")," server on port 8545 for you with Chain ID 1074. You can now  point MetaMask or Hardhat to that server's address on port 8545, and interact with it like any other EVM based chain."),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Re-using an existing Chain ID is not recommended, and can be a security risk. For any serious chain you will be running make sure you register a unique Chain ID on ",(0,o.kt)("a",{parentName:"p",href:"https://chainlist.org/"},"Chainlist")," and use that instead of the default."))),(0,o.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"The current implementation uses the wasp-cli's saves the account to pay for any fees in IOTA while using the JSON-RPC interface.  This is of course not ideal in a normal usage scenario. Upcoming releases  will address this in a more user-friendly way."))),(0,o.kt)("h2",{id:"video-tutorial"},"Video Tutorial"),(0,o.kt)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/JbUGX-9BTSo",title:"EVM Chain Setup",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:!0}))}p.isMDXComponent=!0},22910:function(e,t,a){t.Z=a.p+"assets/files/metamask-a9eb1000ab2aa4bcbc9016721ebb88c0.png"},15115:function(e,t,a){t.Z=a.p+"assets/images/metamask-a9eb1000ab2aa4bcbc9016721ebb88c0.png"},3905:function(e,t,a){a.d(t,{Zo:function(){return d},kt:function(){return p}});var n=a(67294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=n.createContext({}),l=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},d=function(e){var t=l(e.components);return n.createElement(s.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,d=c(e,["components","mdxType","originalType","parentName"]),u=l(a),p=i,m=u["".concat(s,".").concat(p)]||u[p]||h[p]||o;return a?n.createElement(m,r(r({ref:t},d),{},{components:a})):n.createElement(m,r({ref:t},d))}));function p(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=a.length,r=new Array(o);r[0]=u;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:i,r[1]=c;for(var l=2;l<o;l++)r[l]=a[l];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"}}]);