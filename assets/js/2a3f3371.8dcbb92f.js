"use strict";(self.webpackChunkiota_wiki=self.webpackChunkiota_wiki||[]).push([[45394],{22818:function(e,t,a){a.r(t),a.d(t,{assets:function(){return m},contentTitle:function(){return l},default:function(){return u},frontMatter:function(){return s},metadata:function(){return p},toc:function(){return c}});var r=a(87462),n=a(63366),i=(a(67294),a(3905)),o=["components"],s={description:"Runtime aims to provide utilities for performing computations as securely as possible with respect to the underlying operating system. The crate provides three primary Types for guarding data; GuardedVec, Guarded, and Secret.",image:"/img/logo/Stronghold_icon.png",keywords:["rust","crate","Guarded type","memory","allocated","secret"]},l="Structure: Runtime",p={unversionedId:"structure/engine/runtime",id:"structure/engine/runtime",title:"Structure: Runtime",description:"Runtime aims to provide utilities for performing computations as securely as possible with respect to the underlying operating system. The crate provides three primary Types for guarding data; GuardedVec, Guarded, and Secret.",source:"@site/content/build/stronghold.rs/develop/documentation/docs/structure/engine/runtime.md",sourceDirName:"structure/engine",slug:"/structure/engine/runtime",permalink:"/stronghold.rs/structure/engine/runtime",draft:!1,editUrl:"https://github.com/iotaledger/stronghold/edit/dev-refactor/documentation/content/build/stronghold.rs/develop/documentation/docs/structure/engine/runtime.md",tags:[],version:"current",frontMatter:{description:"Runtime aims to provide utilities for performing computations as securely as possible with respect to the underlying operating system. The crate provides three primary Types for guarding data; GuardedVec, Guarded, and Secret.",image:"/img/logo/Stronghold_icon.png",keywords:["rust","crate","Guarded type","memory","allocated","secret"]},sidebar:"mySidebar",previous:{title:"Structure: Engine::Store",permalink:"/stronghold.rs/structure/engine/store"},next:{title:"Structure: Communication",permalink:"/stronghold.rs/structure/p2p"}},m={},c=[],d={toc:c};function u(e){var t=e.components,a=(0,n.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"structure-runtime"},"Structure: Runtime"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null}),(0,i.kt)("th",{parentName:"tr",align:null}),(0,i.kt)("th",{parentName:"tr",align:null}))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/iotaledger/stronghold.rs/tree/dev/engine/runtime"},(0,i.kt)("img",{parentName:"a",src:"https://img.shields.io/badge/github-source-blue.svg",alt:"github"}))),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://docs.rs/stronghold-runtime"},(0,i.kt)("img",{parentName:"a",src:"https://img.shields.io/badge/rust-docs-green.svg",alt:"github"}))),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://crates.io/crates/stronghold-runtime"},(0,i.kt)("img",{parentName:"a",src:"https://img.shields.io/crates/v/stronghold-runtime.svg",alt:null})))))),(0,i.kt)("p",null,(0,i.kt)("h1",{parentName:"p"},"Stronghold new runtime"),(0,i.kt)("p",{parentName:"p"},"This crate provides multiple ways to store data securely whether in ram, disk or fragmented into a non contiguous data structure.\nAll these types of memories implement the ",(0,i.kt)("inlineCode",{parentName:"p"},"LockedMemory")," trait which enables one to allocate or unlock the data stored.\nA ",(0,i.kt)("inlineCode",{parentName:"p"},"Buffer")," type which implements basic security measures is also provided to temporarily store data for any computation."),(0,i.kt)("h2",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"h2"},"Buffer")),(0,i.kt)("p",{parentName:"p"},'Memory which contains some "minimal" security measures such as:'),(0,i.kt)("ul",{parentName:"p"},(0,i.kt)("li",{parentName:"ul"},"Guard areas"),(0,i.kt)("li",{parentName:"ul"},"Canaries "),(0,i.kt)("li",{parentName:"ul"},"Constant time comparisons"),(0,i.kt)("li",{parentName:"ul"},"Zeroes out the memory when dropped "),(0,i.kt)("li",{parentName:"ul"},"Access control of memory pages"),(0,i.kt)("li",{parentName:"ul"},"System flags against memory dumps")),(0,i.kt)("p",{parentName:"p"},"Values in protected memory are stored in clear. Those values are accessible by getting a reference through ",(0,i.kt)("inlineCode",{parentName:"p"},"borrow()")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"borrow_mut()"),".\nSince the values are stored in clear instances of ",(0,i.kt)("inlineCode",{parentName:"p"},"Buffer")," should be as short-lived as possible."),(0,i.kt)("p",{parentName:"p"},"The main functions of ",(0,i.kt)("inlineCode",{parentName:"p"},"Buffer")," are ",(0,i.kt)("inlineCode",{parentName:"p"},"alloc()"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"borrow()"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"borrow_mut"),"."),(0,i.kt)("h2",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"h2"},"LockedMemory")),(0,i.kt)("p",{parentName:"p"},"Locked memory is used to store sensitive data for longer period of times."),(0,i.kt)("p",{parentName:"p"},"You can create a ",(0,i.kt)("inlineCode",{parentName:"p"},"LockedMemory")," instance using ",(0,i.kt)("inlineCode",{parentName:"p"},"alloc()")," or give it a new value with ",(0,i.kt)("inlineCode",{parentName:"p"},"update()"),".\nAs the trait name mentions, the data stored in ",(0,i.kt)("inlineCode",{parentName:"p"},"LockedMemory")," is ",(0,i.kt)("em",{parentName:"p"},"locked")," and you can retrieve using ",(0,i.kt)("inlineCode",{parentName:"p"},"unlock()"),". Unlocked data will be returned in a ",(0,i.kt)("inlineCode",{parentName:"p"},"Buffer"),"."),(0,i.kt)("p",{parentName:"p"},"When allocating a ",(0,i.kt)("inlineCode",{parentName:"p"},"LockedMemory")," you have to choose how it will be stored and how it will be locked.\nThere are 3 types that implement ",(0,i.kt)("inlineCode",{parentName:"p"},"LockedMemory"),": ",(0,i.kt)("inlineCode",{parentName:"p"},"RamMemory"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"FileMemory")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"NonContiguousMemory"),"."),(0,i.kt)("h3",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"h3"},"RamMemory")),(0,i.kt)("p",{parentName:"p"},"Data will be stored in ram memory with the same security measures as the ",(0,i.kt)("inlineCode",{parentName:"p"},"Buffer")," type.\nAdditionally the user can choose to have its data encrypted by providing an encryption key."),(0,i.kt)("p",{parentName:"p"},"Note: ",(0,i.kt)("inlineCode",{parentName:"p"},"RamMemory")," with non encrypted data is essentially a wrapper of the ",(0,i.kt)("inlineCode",{parentName:"p"},"Buffer")," type."),(0,i.kt)("h3",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"h3"},"FileMemory")),(0,i.kt)("p",{parentName:"p"},"Data is stored in disk memory and can be encrypted."),(0,i.kt)("p",{parentName:"p"},"Security measures to protect the files:"),(0,i.kt)("ul",{parentName:"p"},(0,i.kt)("li",{parentName:"ul"},"Access control of the files (os-dependent)"),(0,i.kt)("li",{parentName:"ul"},"Data is mixed with noise "),(0,i.kt)("li",{parentName:"ul"},"File is zeroed and removed when dropped")),(0,i.kt)("p",{parentName:"p"},"Note: usually disk memory is more vulnerable than ram memory but we believe that using diverse types of memories increases the data security."),(0,i.kt)("h3",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"h3"},"NonContiguousMemory")),(0,i.kt)("p",{parentName:"p"},"Data is split into two shards using the ",(0,i.kt)("a",{parentName:"p",href:"https://spacetime.dev/encrypting-secrets-in-memory"},"Boojum scheme"),".\nBasically the data is split into two:"),(0,i.kt)("ul",{parentName:"p"},(0,i.kt)("li",{parentName:"ul"},"one shard is random data"),(0,i.kt)("li",{parentName:"ul"},"other shard is data xored with a hash of the first shard")),(0,i.kt)("p",{parentName:"p"},"Data is reconstructed by xoring the second shard with a hash of the first shard."),(0,i.kt)("p",{parentName:"p"},"Non contiguous memory improves security through forcing an attacker to recover multiple pieces to get the original data.\nUser can choose to have data split in ram memory or in ram and disk (to diversify memory storage)."),(0,i.kt)("p",{parentName:"p"},"Moreover the shards can be ",(0,i.kt)("em",{parentName:"p"},"refreshed")," regularly.\nValues of the shards will be modified separately such that the original data can still be reconstructed."),(0,i.kt)("p",{parentName:"p"},"Note: data in shard is xored with a hash digest, hence the data stored in non contiguous memory can only have size of a hash digest. This may seem restrictive but it fits well when following the usage recommendation described in the next section."),(0,i.kt)("h2",{parentName:"p"},"Usage recommendation"),(0,i.kt)("p",{parentName:"p"},"Our recommendation on how to use the crate to store sensitive data."),(0,i.kt)("ul",{parentName:"p"},(0,i.kt)("li",{parentName:"ul"},"Data is stored encrypted in ",(0,i.kt)("inlineCode",{parentName:"li"},"RamMemory")),(0,i.kt)("li",{parentName:"ul"},"The encryption key is stored in ",(0,i.kt)("inlineCode",{parentName:"li"},"NonContiguousMemory")," over ram and disk")),(0,i.kt)("p",{parentName:"p"},"Hence data security depends on the strength of the encryption scheme and the 'obfuscation' of the encryption key in non contiguous memory."),(0,i.kt)("h1",{parentName:"p"},"Objectives"),(0,i.kt)("ul",{parentName:"p",className:"contains-task-list"},(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ","Stable ",(0,i.kt)("inlineCode",{parentName:"li"},"LockedMemory")," API"),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ","Implementation ",(0,i.kt)("ul",{parentName:"li",className:"contains-task-list"},(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("inlineCode",{parentName:"li"},"Buffer")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("inlineCode",{parentName:"li"},"RamMemory")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ",(0,i.kt)("inlineCode",{parentName:"li"},"FileMemory"),(0,i.kt)("ul",{parentName:"li",className:"contains-task-list"},(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","data mixed with noise"))),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("inlineCode",{parentName:"li"},"NonContiguousMemory")," "))),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","Tests",(0,i.kt)("ul",{parentName:"li",className:"contains-task-list"},(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ","Functional correctness"),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","Security ",(0,i.kt)("ul",{parentName:"li",className:"contains-task-list"},(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ","zeroize "),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","access to the locked memory"))))),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","Benchmarks"),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","no-std"))),(0,i.kt)("p",null,"The primary components are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Guarded")," - A guarded type for protecting fixed-length secrets allocated on the heap."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"GuardedVec")," - A guarded type for protecting variable-length secrets allocated on the heap."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Secret")," - A Type for guarding secrets allocated to the stack."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"ZeroingAlloc")," - A Zeroing Allocator which wraps the standard memory allocator. This allocator zeroes out memory when it is dropped.")))}u.isMDXComponent=!0},3905:function(e,t,a){a.d(t,{Zo:function(){return m},kt:function(){return u}});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=r.createContext({}),p=function(e){var t=r.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},m=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),d=p(a),u=n,k=d["".concat(l,".").concat(u)]||d[u]||c[u]||i;return a?r.createElement(k,o(o({ref:t},m),{},{components:a})):r.createElement(k,o({ref:t},m))}));function u(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,o=new Array(i);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:n,o[1]=s;for(var p=2;p<i;p++)o[p]=a[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}d.displayName="MDXCreateElement"}}]);